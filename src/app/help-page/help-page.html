<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
  <div class="container-fluid">

    <a class="navbar-brand fw-bold text-success" routerLink="/">
      <i class="fas fa-leaf me-2"></i>Pollution Report
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" title="Toggle navigation menu" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-center">
        <li class="nav-item">
          <a class="nav-link" routerLink="/">
            <i class="fas fa-home me-1"></i> Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active">
            <i class="fas fa-question-circle me-1"></i> Help
          </a>
        </li>
        <li class="nav-item" *ngIf="user$ | async as user">
          <a class="nav-link" routerLink="/settings">
            <i class="fas fa-cog me-1"></i> Settings
          </a>
        </li>
        <li class="nav-item" *ngIf="(user$ | async)?.role === 'admin'">
          <a class="nav-link d-flex align-items-center" routerLink="/admin">
            <i class="fas fa-shield-alt me-1"></i> Admin
            @if (adminPendingApprovalCount > 0) {
              <span class="badge bg-danger ms-1 notification-badge">{{ adminPendingApprovalCount > 99 ? '99+' : adminPendingApprovalCount }}</span>
            }
          </a>
        </li>
        <li class="nav-item ms-lg-3" *ngIf="(user$ | async) && (user$ | async)?.role !== 'admin'">
          <a class="btn btn-success" routerLink="/submit-report"><i class="fas fa-plus me-1"></i> New Report</a>
        </li>
        <li class="nav-item dropdown ms-lg-2 profile-dropdown" *ngIf="user$ | async as user">
          <a class="nav-link dropdown-toggle d-flex align-items-center position-relative" href="#" role="button" (click)="toggleProfileMenu($event)" [attr.aria-expanded]="showProfileMenu" title="User menu" aria-label="User menu">
            <img *ngIf="user.profilePictureUrl; else userIcon"
                 [src]="user.profilePictureUrl"
                 alt="Profile"
                 class="rounded-circle"
                 style="width: 32px; height: 32px; object-fit: cover; border: 2px solid #198754;">
            <ng-template #userIcon>
              <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center"
                   style="width: 32px; height: 32px; font-size: 0.9rem;">
                {{ (user.username || user.fullName || user.email || 'U').charAt(0).toUpperCase() }}
              </div>
            </ng-template>
            @if (unreadNotificationCount > 0) {
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger profile-notification-badge">{{ unreadNotificationCount > 9 ? '9+' : unreadNotificationCount }}</span>
            }
          </a>
          <ul class="dropdown-menu dropdown-menu-end" [class.show]="showProfileMenu">
            <li><a class="dropdown-item" routerLink="/profile"><i class="fas fa-user me-2"></i>My Profile</a></li>
            <li>
              <a class="dropdown-item d-flex justify-content-between align-items-center" routerLink="/notifications">
                <span><i class="fas fa-bell me-2"></i>Notifications</span>
                <span *ngIf="unreadNotificationCount > 0" class="badge bg-danger rounded-pill">{{ unreadNotificationCount > 99 ? '99+' : unreadNotificationCount }}</span>
              </a>
            </li>
            <li><a class="dropdown-item" routerLink="/settings"><i class="fas fa-cog me-2"></i>Settings</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" (click)="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
          </ul>
        </li>
        <!-- Not logged in - show login button -->
        <li class="nav-item ms-lg-3" *ngIf="!(user$ | async)">
          <a class="btn btn-success" routerLink="/login"><i class="fas fa-sign-in-alt me-1"></i> Login</a>
        </li>
      </ul>
    </div>

  </div>
</nav>

<!-- Help Content -->
<div class="container py-5">
  <div class="row">
    <div class="col-lg-8 mx-auto">

      <h1 class="fw-bold mb-2">Help & Information</h1>
      <p class="text-muted mb-5">
        Find answers to common questions about using the pollution reporting system
      </p>

      <!-- FAQ Accordion -->
      <div class="accordion" id="helpAccordion">

        <!-- FAQ 1 -->
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
              <i class="fas fa-info-circle text-primary me-2"></i>
              <strong>How does the pollution reporting system work?</strong>
            </button>
          </h2>

          <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
            <div class="accordion-body">
              <p>The pollution reporting system connects citizens with barangay officials to address environmental issues:</p>
              <ol>
                <li><strong>Report:</strong> Citizens submit reports with photos, location, and description</li>
                <li><strong>Review:</strong> Admins receive and review reports</li>
                <li><strong>Respond:</strong> Admins update status and communicate</li>
                <li><strong>Resolve:</strong> Issues are addressed and marked as resolved</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- FAQ 2 -->
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
              <i class="fas fa-file-alt text-success me-2"></i>
              <strong>What information should I include in a report?</strong>
            </button>
          </h2>

          <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
            <div class="accordion-body">
              <p>A complete pollution report should include:</p>
              <ul>
                <li><strong>Type of Pollution:</strong> Water, Air, or Land</li>
                <li><strong>Location:</strong> Address or landmark</li>
                <li><strong>Date & Time:</strong> When it was seen</li>
                <li><strong>Photos:</strong> Clear required images</li>
                <li><strong>Description:</strong> Detailed explanation</li>
              </ul>

              <div class="alert alert-info">
                <i class="fas fa-lightbulb me-1"></i>
                <strong>Tip:</strong> More details = faster response!
              </div>
            </div>
          </div>
        </div>

        <!-- FAQ 3 -->
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
              <i class="fas fa-check-circle text-warning me-2"></i>
              <strong>How will admins resolve my report?</strong>
            </button>
          </h2>

          <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
            <div class="accordion-body">
              <ol>
                <li>Status becomes <strong>Pending</strong></li>
                <li>Admin reviews and investigates</li>
                <li>Status becomes <strong>In Progress</strong></li>
                <li>Issue resolved and marked <strong>Done</strong></li>
              </ol>
            </div>
          </div>
        </div>

        <!-- FAQ 4 -->
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
              <i class="fas fa-arrow-up text-danger me-2"></i>
              <strong>What does upvoting do?</strong>
            </button>
          </h2>

          <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
            <div class="accordion-body">
              <p>Upvoting helps:</p>
              <ul>
                <li>Prioritize community issues</li>
                <li>Show support</li>
                <li>Admins identify urgent concerns</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- FAQ 5 -->
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
              <i class="fas fa-shield-alt text-info me-2"></i>
              <strong>Is my information private?</strong>
            </button>
          </h2>

          <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
            <div class="accordion-body">
              <ul>
                <li>Your name/photo show on reports</li>
                <li>Contact info visible only to admins</li>
                <li>You can edit info anytime</li>
                <li>No anonymous reporting</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- FAQ 6 -->
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
              <i class="fas fa-user-cog text-secondary me-2"></i>
              <strong>I forgot my password. What should I do?</strong>
            </button>
          </h2>

          <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
            <div class="accordion-body">
              <ol>
                <li>Go to login page</li>
                <li>Click "Reset password"</li>
                <li>Enter your email</li>
                <li>Check your inbox</li>
                <li>Reset your password</li>
              </ol>

              <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle me-1"></i>
                Check spam folder if no email arrives.
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Emergency Contacts Section -->
      <div class="mt-5">
        <h3 class="fw-bold mb-4">
          <i class="fas fa-phone-alt text-danger me-2"></i>
          Baguio City Emergency Contacts
        </h3>
        <p class="text-muted mb-4">Important contact numbers for reporting emergencies and environmental concerns in Baguio City.</p>

        <div class="row g-3">
          <!-- National Emergency -->
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm emergency-card">
              <div class="card-body d-flex align-items-center">
                <div class="emergency-icon bg-danger">
                  <i class="fas fa-ambulance"></i>
                </div>
                <div class="ms-3">
                  <h6 class="fw-bold mb-1">National Emergency</h6>
                  <p class="text-muted small mb-1">Police, Fire, Medical</p>
                  <a href="tel:911" class="text-decoration-none fw-semibold">
                    <i class="fas fa-phone me-1"></i>911
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- BFP -->
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm emergency-card">
              <div class="card-body d-flex align-items-center">
                <div class="emergency-icon bg-warning">
                  <i class="fas fa-fire-extinguisher"></i>
                </div>
                <div class="ms-3">
                  <h6 class="fw-bold mb-1">Bureau of Fire Protection</h6>
                  <p class="text-muted small mb-1">Fire Emergency - Baguio</p>
                  <a href="tel:160" class="text-decoration-none fw-semibold">
                    <i class="fas fa-phone me-1"></i>160 (BFP Hotline)
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- PNP -->
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm emergency-card">
              <div class="card-body d-flex align-items-center">
                <div class="emergency-icon bg-primary">
                  <i class="fas fa-shield-alt"></i>
                </div>
                <div class="ms-3">
                  <h6 class="fw-bold mb-1">Philippine National Police</h6>
                  <p class="text-muted small mb-1">Police Emergency</p>
                  <a href="tel:117" class="text-decoration-none fw-semibold">
                    <i class="fas fa-phone me-1"></i>117 (PNP Hotline)
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- DENR-CAR -->
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm emergency-card">
              <div class="card-body d-flex align-items-center">
                <div class="emergency-icon bg-success">
                  <i class="fas fa-leaf"></i>
                </div>
                <div class="ms-3">
                  <h6 class="fw-bold mb-1">DENR-CAR</h6>
                  <p class="text-muted small mb-1">Environmental Complaints</p>
                  <a href="tel:+63744424531" class="text-decoration-none fw-semibold">
                    <i class="fas fa-phone me-1"></i>(074) 442-4531
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- City Mayor's Office -->
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm emergency-card">
              <div class="card-body d-flex align-items-center">
                <div class="emergency-icon bg-info">
                  <i class="fas fa-landmark"></i>
                </div>
                <div class="ms-3">
                  <h6 class="fw-bold mb-1">City Government of Baguio</h6>
                  <p class="text-muted small mb-1">LGU Viber Hotline</p>
                  <a href="tel:+639458237040" class="text-decoration-none fw-semibold">
                    <i class="fab fa-viber me-1"></i>+63 945 823 7040
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- Red Cross -->
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm emergency-card">
              <div class="card-body d-flex align-items-center">
                <div class="emergency-icon bg-secondary" style="background-color: #dc3545 !important;">
                  <i class="fas fa-plus"></i>
                </div>
                <div class="ms-3">
                  <h6 class="fw-bold mb-1">Philippine Red Cross</h6>
                  <p class="text-muted small mb-1">Emergency Response</p>
                  <a href="tel:143" class="text-decoration-none fw-semibold">
                    <i class="fas fa-phone me-1"></i>143 (PRC Hotline)
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Emergency Tip -->
        <div class="alert alert-info mt-4 d-flex align-items-center">
          <i class="fas fa-info-circle fa-2x me-3"></i>
          <div>
            <strong>For pollution-related concerns</strong>, you can submit a report through this app or contact your barangay office directly. For immediate environmental hazards, contact DENR-CAR.
          </div>
        </div>
      </div>

      <!-- Contact Section -->
      <div class="card mt-5 border-success">
        <div class="card-body text-center p-4">
          <i class="fas fa-envelope fa-3x text-success mb-3"></i>
          <h4 class="fw-bold">Still need help?</h4>
          <p class="text-muted">Contact your barangay office for additional support</p>

          <div class="d-flex flex-column align-items-center gap-2">
            <div>
              <strong class="text-success">{{ barangayName$ | async }}</strong>
            </div>
            <div>
              <i class="fas fa-phone text-success me-1"></i>
              <strong>{{ barangayAdminContact$ | async }}</strong>
            </div>
            <div>
              <i class="fas fa-envelope text-success me-1"></i>
              <strong>{{ barangayAdminEmail$ | async }}</strong>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Mobile Bottom Navigation (visible only on mobile) -->
<nav class="mobile-bottom-nav d-md-none">
  <a routerLink="/" class="mobile-nav-item" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
    <i class="fas fa-home"></i>
    <span>Home</span>
  </a>
  @if ((user$ | async)?.role !== 'admin') {
    <a routerLink="/submit-report" class="mobile-nav-item" routerLinkActive="active">
      <i class="fas fa-plus-circle"></i>
      <span>Report</span>
    </a>
  }
  <a routerLink="/notifications" class="mobile-nav-item position-relative" routerLinkActive="active">
    <i class="fas fa-bell"></i>
    <span>Alerts</span>
    @if (unreadNotificationCount > 0) {
      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger mobile-badge">{{ unreadNotificationCount > 9 ? '9+' : unreadNotificationCount }}</span>
    }
  </a>
  <a routerLink="/help" class="mobile-nav-item active">
    <i class="fas fa-question-circle"></i>
    <span>Help</span>
  </a>
  <a routerLink="/profile" class="mobile-nav-item" routerLinkActive="active">
    <i class="fas fa-user"></i>
    <span>Account</span>
  </a>
</nav>
